<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Admin Panel Collentmart</title>
</head>
<body>
  <h1>Tambah Produk</h1>
  <input id="nama" placeholder="Nama Produk">
  <input id="harga" placeholder="Harga Produk" type="number">
  <input id="gambar" placeholder="URL Gambar Produk">
  <button onclick="uploadProduk()">Upload Produk</button>

  <ul id="daftar-produk">Memuat...</ul>

  <script>
    const BIN_ID = "685ae0118a456b7966b4eef3";
    const API_KEY = "$2a$10$gJ2hsyhsXcL9CFSSvCU2O.n8jzk1NdscM1GXhJ4I8aeoJz8iuTzyq";

    async function loadProduk() {
      const res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
        headers: { "X-Master-Key": API_KEY }
      });
      const data = await res.json();
      const daftar = document.getElementById("daftar-produk");
      daftar.innerHTML = "";
      data.record.forEach(p => {
        daftar.innerHTML += `<li>${p.nama} - Rp${p.harga}</li>`;
      });
    }

    async function uploadProduk() {
      const nama = document.getElementById("nama").value;
      const harga = parseInt(document.getElementById("harga").value);
      const gambar = document.getElementById("gambar").value;

      const res = await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
        headers: { "X-Master-Key": API_KEY }
      });
      const data = await res.json();
      const produk = data.record;

      produk.push({ id: Date.now(), nama, harga, gambar });

      await fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
        method: "PUT",
        headers: {
          "Content-Type": "application/json",
          "X-Master-Key": API_KEY
        },
        body: JSON.stringify({ record: produk })
      });

      alert("Produk berhasil ditambahkan!");
      loadProduk();
    }

    window.onload = loadProduk;
  </script>
</body>
</html>
